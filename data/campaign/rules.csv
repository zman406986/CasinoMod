id,trigger,conditions,script,text,options
# Add the Visit Casino option to markets (both stations and colonies)
# Only available on player-owned markets and Tri-Tachyon markets
casino_add_option_player,PopulateOptions,"$hasMarket
$marketSize >= 3
$menuState == main
$tradeMode == OPEN
!$global.casino_disabled
$faction.id == player",,,20:visit_casino:Visit Casino,
casino_add_option_tritachyon,PopulateOptions,"$hasMarket
$marketSize >= 3
$menuState == main
$tradeMode == OPEN
!$global.casino_disabled
$faction.id == tritachyon",,,20:visit_casino:Visit Casino,
# Handle when the Visit Casino option is selected from market interaction
casino_visit_selected,DialogOptionSelected,$option == visit_casino,Casino_StartCasinoInteraction,,
# ========================================
# Debt Collector Fleet Encounter Rules
# Following TriTachLoanIncentiveScript pattern (ttli_bountyHunter)
# ========================================
# Hail when fleet intercepts player - prevent repeated hails with ignorePlayerCommRequests
casino_debtCollectorHail,BeginFleetEncounter,"$ipc_debt_collector score:1000
!$ignorePlayerCommRequests","AddText ""You're being hailed by the $faction $otherShipOrFleet."" $faction.baseColor
$hailing = true 0",,
# Open comm link with debt collector - hostile message, fight is unavoidable
casino_debtCollectorOpenComm,OpenCommLink,"$entity.ipc_debt_collector score:1000
!$entity.ignorePlayerCommRequests","$entity.ignorePlayerCommRequests = true
SetShortcut cutCommLinkNoText ""ESCAPE""","""You had your fun, now it's time to pay.""

The comm link goes dead in a crackle of static.",cutCommLinkNoText:Continue,
